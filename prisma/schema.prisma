generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// ==================== USUÁRIO ====================
model Usuario {
  id        String   @id @default(cuid())
  nome      String
  email     String   @unique
  senha     String   // Hash do bcrypt
  ativo     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("usuarios")
}

// ==================== MOTORISTA ====================
model Motorista {
  id        String   @id @default(cuid())
  nome      String
  cpf       String   @unique
  telefone  String
  ativo     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relacionamentos
  fretes Frete[]

  @@map("motoristas")
}

// ==================== CAMINHÃO ====================
model Caminhao {
  id        String   @id @default(cuid())
  placa     String   @unique
  modelo    String
  capacidade Float    // Em toneladas
  ativo     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relacionamentos
  fretes Frete[]

  @@map("caminhoes")
}

// ==================== FRETE ====================
enum StatusFrete {
  PENDENTE
  EM_TRANSITO
  CONCLUIDO
  CANCELADO
}

model Frete {
  id           String       @id @default(cuid())
  origem       String
  destino      String
  status       StatusFrete  @default(PENDENTE)
  receita      Float        @default(0)
  custos       Float        @default(0)
  resultado    Float        @default(0) // receita - custos
  descricao    String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  dataPartida  DateTime?
  dataChegada  DateTime?

  // Chaves estrangeiras
  motoristaId String
  caminhaoId  String

  // Relacionamentos
  motorista Motorista @relation(fields: [motoristaId], references: [id], onDelete: Cascade)
  caminhao  Caminhao  @relation(fields: [caminhaoId], references: [id], onDelete: Cascade)

  @@map("fretes")
}
